# Cell-Type Annotation Benchmarking: Results Summary

Automated summary generated by `bin/generate_results_summary.py`. Evaluates cell-type annotation accuracy across methods (scvi, seurat), confidence cutoffs (0.0–0.75), reference atlases, and subsample sizes for datasets found in `2024-07-01/`.

---

## Dataset: homo_sapiens_new

**Studies:** 9  **Methods:** scvi, seurat  
**Cutoffs evaluated:** 0.0 – 0.75  **References:** 10  **Subsample sizes:** 50, 100, 500

### Method Comparison (model-adjusted marginal means)

| Taxonomy level | seurat | scvi |
| --- | --- | --- |
| global | 0.972 [0.946–0.986] | 0.986 [0.973–0.993] |
| class | 0.906 [0.742–0.970] | 0.941 [0.826–0.981] |
| family | 0.939 [0.809–0.982] | 0.971 [0.901–0.992] |
| subclass | 0.882 [0.703–0.959] | 0.923 [0.792–0.974] |

At subclass level, scvi outperforms seurat (Δ = 0.042, model-adjusted marginal means: scvi 0.923, seurat 0.882).

### Cutoff Sensitivity

| Cutoff | scvi | seurat |
| --- | --- | --- |
| 0.0 | 0.905 | 0.869 |
| 0.05 | 0.892 | 0.865 |
| 0.1 | 0.879 | 0.861 |
| 0.15 | 0.863 | 0.857 |
| 0.2 | 0.846 | 0.853 |
| 0.25 | 0.828 | 0.848 |
| 0.5 | 0.709 | 0.825 |
| 0.75 | 0.551 | 0.798 |

scvi: performance decreases by 0.354 from cutoff 0.0 to 0.75.
seurat: performance decreases by 0.071 from cutoff 0.0 to 0.75.

### Reference Comparison (subclass, model-adjusted)

| Reference | scvi | seurat |
| --- | --- | --- |
| Dissection A1 | 0.907 | 0.875 |
| Dissection ACC | 0.91 | 0.879 |
| Dissection AnG | 0.911 | 0.883 |
| Dissection DFC | 0.854 | 0.785 |
| Dissection S1 | 0.908 | 0.872 |
| Dissection V1 | 0.902 | 0.877 |
| Human MC SMART-seq | 0.842 | 0.815 |
| SEA-AD DLPFC | 0.926 | 0.889 |
| SEA-AD MTG | 0.92 | 0.884 |
| whole cortex | 0.923 | 0.882 |

Best-performing reference (mean across methods): **SEA-AD DLPFC**. Lowest: **Dissection DFC**.

### Cell-Type Performance (subclass, best config per label)

#### Consistently well-classified (mean_f1 ≥ 0.90, ≥ 3 studies)

| label | best_method | best_reference | best_subsample | mean_f1 | n_studies |
| --- | --- | --- | --- | --- | --- |
| Non-neuron | seurat | Dissection ACC | 500 | 1.0 | 6 |
| Vascular | scvi | Dissection A1 | 500 | 0.991 | 7 |
| Astrocyte | scvi | SEA-AD MTG | 100 | 0.988 | 8 |
| L2/3-6 IT | scvi | SEA-AD DLPFC | 500 | 0.985 | 7 |
| Microglia | scvi | Dissection AnG | 500 | 0.98 | 8 |
| Chandelier | scvi | whole cortex | 100 | 0.976 | 6 |
| L5/6 NP | seurat | Human MC SMART-seq | 50 | 0.968 | 7 |
| Oligodendrocyte | scvi | Dissection AnG | 500 | 0.944 | 9 |
| LAMP5 | seurat | Human MC SMART-seq | 100 | 0.94 | 7 |
| SST | seurat | whole cortex | 100 | 0.931 | 7 |
| VIP | scvi | Dissection AnG | 500 | 0.93 | 7 |
| VLMC | seurat | Human MC SMART-seq | 50 | 0.928 | 6 |
| Endothelial | scvi | SEA-AD DLPFC | 100 | 0.921 | 7 |
| PVALB | seurat | Dissection DFC | 50 | 0.918 | 7 |

#### Hardest cell types (mean_f1 < 0.75)

| label | mean_f1 | std_f1 | n_studies | notes |
| --- | --- | --- | --- | --- |
| L5 ET | 0.709 | 0.329 | 7 | — |


### Study Variance

| label | n_studies | frac_studies | mean_f1 | std_f1 | min_f1 | max_f1 |
| --- | --- | --- | --- | --- | --- | --- |
| L5 ET | 7 | 0.778 | 0.574 | 0.322 | 0.106 | 0.945 |
| OPC | 9 | 1.0 | 0.849 | 0.307 | 0.031 | 0.973 |
| Oligodendrocyte | 9 | 1.0 | 0.929 | 0.16 | 0.502 | 0.996 |
| VLMC | 6 | 0.667 | 0.686 | 0.147 | 0.52 | 0.85 |
| PAX6 | 6 | 0.667 | 0.826 | 0.142 | 0.609 | 0.957 |
| GABAergic | 2 | 0.222 | 0.891 | 0.123 | 0.805 | 0.978 |
| L6b | 7 | 0.778 | 0.782 | 0.117 | 0.62 | 0.954 |
| Vascular | 7 | 0.778 | 0.86 | 0.115 | 0.639 | 0.95 |
| Endothelial | 7 | 0.778 | 0.791 | 0.104 | 0.634 | 0.904 |
| L6 CT | 7 | 0.778 | 0.796 | 0.1 | 0.661 | 0.967 |

Cell type with highest study-to-study variability: **L5 ET** (std_f1 = 0.322).


---

## Dataset: mmus_new

**Studies:** 7  **Methods:** scvi, seurat  
**Cutoffs evaluated:** 0.0 – 0.75  **References:** 4  **Subsample sizes:** 50, 100, 500

### Method Comparison (model-adjusted marginal means)

| Taxonomy level | seurat | scvi |
| --- | --- | --- |
| global | 0.968 [0.946–0.981] | 0.974 [0.956–0.985] |
| class | 0.806 [0.702–0.880] | 0.843 [0.754–0.905] |
| family | 0.876 [0.834–0.909] | 0.911 [0.879–0.935] |
| subclass | 0.796 [0.703–0.866] | 0.829 [0.746–0.889] |

At subclass level, scvi outperforms seurat (Δ = 0.033, model-adjusted marginal means: scvi 0.829, seurat 0.796).

### Cutoff Sensitivity

| Cutoff | scvi | seurat |
| --- | --- | --- |
| 0.0 | 0.803 | 0.786 |
| 0.05 | 0.778 | 0.782 |
| 0.1 | 0.75 | 0.779 |
| 0.15 | 0.721 | 0.775 |
| 0.2 | 0.689 | 0.771 |
| 0.25 | 0.655 | 0.767 |
| 0.5 | 0.469 | 0.747 |
| 0.75 | 0.292 | 0.726 |

scvi: performance decreases by 0.511 from cutoff 0.0 to 0.75.
seurat: performance decreases by 0.060 from cutoff 0.0 to 0.75.

### Reference Comparison (subclass, model-adjusted)

| Reference | scvi | seurat |
| --- | --- | --- |
| hippocampal 10x | 0.822 | 0.797 |
| hippocampal SMART-Seq | 0.754 | 0.73 |
| motor cortex | 0.824 | 0.835 |
| whole cortex | 0.829 | 0.796 |

Best-performing reference (mean across methods): **motor cortex**. Lowest: **hippocampal SMART-Seq**.

### Cell-Type Performance (subclass, best config per label)

#### Consistently well-classified (mean_f1 ≥ 0.90, ≥ 3 studies)

| label | best_method | best_reference | best_subsample | mean_f1 | n_studies |
| --- | --- | --- | --- | --- | --- |
| GABAergic | seurat | hippocampal SMART-Seq | 50 | 0.99 | 4 |
| Endothelial | seurat | hippocampal 10x | 500 | 0.987 | 6 |
| Glutamatergic | seurat | hippocampal SMART-Seq | 50 | 0.978 | 4 |
| Oligodendrocyte | seurat | motor cortex | 100 | 0.975 | 6 |
| Astrocyte | seurat | hippocampal 10x | 500 | 0.942 | 6 |

#### Hardest cell types (mean_f1 < 0.75)

| label | mean_f1 | std_f1 | n_studies | notes |
| --- | --- | --- | --- | --- |
| OPC | 0.085 | 0.11 | 6 | — |
| Macrophage | 0.255 | 0.087 | 2 | rare (<2 studies) |
| Microglia | 0.272 | 0.306 | 6 | — |


### Study Variance

| label | n_studies | frac_studies | mean_f1 | std_f1 | min_f1 | max_f1 |
| --- | --- | --- | --- | --- | --- | --- |
| Cajal-Retzius cell | 2 | 0.286 | 0.526 | 0.199 | 0.386 | 0.667 |
| Macrophage | 2 | 0.286 | 0.205 | 0.077 | 0.151 | 0.26 |
| Glutamatergic | 4 | 0.571 | 0.948 | 0.075 | 0.836 | 0.99 |
| Oligodendrocyte | 6 | 0.857 | 0.822 | 0.074 | 0.733 | 0.949 |
| Astrocyte | 6 | 0.857 | 0.88 | 0.072 | 0.807 | 0.985 |
| Vascular | 2 | 0.286 | 0.872 | 0.046 | 0.84 | 0.905 |
| Microglia | 6 | 0.857 | 0.101 | 0.038 | 0.053 | 0.139 |
| GABAergic | 4 | 0.571 | 0.899 | 0.037 | 0.848 | 0.934 |
| Endothelial | 6 | 0.857 | 0.951 | 0.029 | 0.909 | 0.991 |
| OPC | 6 | 0.857 | 0.01 | 0.01 | 0.0 | 0.029 |

Cell type with highest study-to-study variability: **Cajal-Retzius cell** (std_f1 = 0.199).


---

## Dataset: mus_musculus

**Studies:** 7  **Methods:** scvi, seurat  
**Cutoffs evaluated:** 0.0 – 0.75  **References:** 4  **Subsample sizes:** 50, 100, 500

### Method Comparison (model-adjusted marginal means)

| Taxonomy level | seurat | scvi |
| --- | --- | --- |
| global | 0.927 [0.864–0.963] | 0.966 [0.934–0.983] |
| class | 0.791 [0.676–0.873] | 0.839 [0.741–0.904] |
| family | 0.855 [0.800–0.897] | 0.904 [0.864–0.933] |
| subclass | 0.773 [0.668–0.853] | 0.822 [0.731–0.887] |

At subclass level, scvi outperforms seurat (Δ = 0.049, model-adjusted marginal means: scvi 0.822, seurat 0.773).

### Cutoff Sensitivity

| Cutoff | scvi | seurat |
| --- | --- | --- |
| 0.0 | 0.793 | 0.772 |
| 0.05 | 0.768 | 0.769 |
| 0.1 | 0.74 | 0.765 |
| 0.15 | 0.71 | 0.761 |
| 0.2 | 0.678 | 0.757 |
| 0.25 | 0.644 | 0.753 |
| 0.5 | 0.461 | 0.733 |
| 0.75 | 0.287 | 0.712 |

scvi: performance decreases by 0.506 from cutoff 0.0 to 0.75.
seurat: performance decreases by 0.060 from cutoff 0.0 to 0.75.

### Reference Comparison (subclass, model-adjusted)

| Reference | scvi | seurat |
| --- | --- | --- |
| hippocampal 10x | 0.807 | 0.779 |
| hippocampal SMART-Seq | 0.74 | 0.716 |
| motor cortex | 0.819 | 0.833 |
| whole cortex | 0.822 | 0.773 |

Best-performing reference (mean across methods): **motor cortex**. Lowest: **hippocampal SMART-Seq**.

### Cell-Type Performance (subclass, best config per label)

#### Consistently well-classified (mean_f1 ≥ 0.90, ≥ 3 studies)

| label | best_method | best_reference | best_subsample | mean_f1 | n_studies |
| --- | --- | --- | --- | --- | --- |
| GABAergic | seurat | hippocampal SMART-Seq | 50 | 0.99 | 4 |
| Endothelial | seurat | hippocampal 10x | 500 | 0.986 | 6 |
| Glutamatergic | seurat | hippocampal SMART-Seq | 50 | 0.978 | 4 |
| Oligodendrocyte | seurat | motor cortex | 100 | 0.974 | 6 |
| Astrocyte | seurat | hippocampal 10x | 500 | 0.943 | 6 |

#### Hardest cell types (mean_f1 < 0.75)

| label | mean_f1 | std_f1 | n_studies | notes |
| --- | --- | --- | --- | --- |
| OPC | 0.199 | 0.167 | 6 | — |
| Macrophage | 0.247 | 0.08 | 2 | rare (<2 studies) |
| Neural stem cell | 0.452 | 0.163 | 2 | rare (<2 studies) |
| Microglia | 0.459 | 0.393 | 6 | — |


### Study Variance

| label | n_studies | frac_studies | mean_f1 | std_f1 | min_f1 | max_f1 |
| --- | --- | --- | --- | --- | --- | --- |
| Cajal-Retzius cell | 2 | 0.286 | 0.506 | 0.227 | 0.345 | 0.667 |
| Neuron | 2 | 0.286 | 0.796 | 0.127 | 0.706 | 0.886 |
| Macrophage | 2 | 0.286 | 0.203 | 0.08 | 0.146 | 0.26 |
| Glutamatergic | 4 | 0.571 | 0.944 | 0.075 | 0.832 | 0.983 |
| Oligodendrocyte | 6 | 0.857 | 0.83 | 0.068 | 0.752 | 0.95 |
| Astrocyte | 6 | 0.857 | 0.885 | 0.067 | 0.811 | 0.981 |
| Neural stem cell | 2 | 0.286 | 0.155 | 0.051 | 0.118 | 0.191 |
| GABAergic | 4 | 0.571 | 0.884 | 0.049 | 0.825 | 0.936 |
| Vascular | 2 | 0.286 | 0.869 | 0.048 | 0.835 | 0.903 |
| Microglia | 6 | 0.857 | 0.116 | 0.037 | 0.071 | 0.168 |

Cell type with highest study-to-study variability: **Cajal-Retzius cell** (std_f1 = 0.227).


---
