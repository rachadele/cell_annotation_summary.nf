/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Config file for defining DSL2 per module options and publishing paths
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/

process {

    withName: 'ADD_PARAMS' {
        publishDir = [
            path: { "${params.outdir}/params_added" },
            mode: 'copy'
        ]
    }

    withName: 'AGGREGATE_RESULTS' {
        publishDir = [
            [
                path: { "${params.outdir}/aggregated_results/figs" },
                mode: 'copy',
                pattern: "**png"
            ],
            [
                path: { "${params.outdir}/aggregated_results/files" },
                mode: 'copy',
                pattern: "**tsv"
            ]
        ]
    }

    withName: 'PLOT_CUTOFF' {
        publishDir = [
            path: { "${params.outdir}/cutoff_plots" },
            mode: 'copy'
        ]
    }

    withName: 'PLOT_COMPTIME' {
        publishDir = [
            path: { "${params.outdir}/comptime_plots" },
            mode: 'copy'
        ]
    }

    withName: 'PLOT_LABEL_DIST' {
        publishDir = [
            path: { "${params.outdir}/label_dists" },
            mode: 'copy'
        ]
    }

    withName: 'MODEL_EVAL_WEIGHTED' {
        publishDir = [
            path: { "${params.outdir}/weighted_models" },
            mode: 'copy'
        ]
    }

    withName: 'SPLIT_BY_LABEL' {
        publishDir = [
            path: { "${params.outdir}/label_splits" },
            mode: 'copy'
        ]
    }

    withName: 'MODEL_EVAL_LABEL' {
        publishDir = [
            path: { "${params.outdir}/label_models/" },
            mode: 'copy'
        ]
    }

    withName: 'PLOT_CONTRASTS' {
        publishDir = [
            path: { "${params.outdir}/contrast_figs/discrete/weighted/${key}" },
            mode: 'copy'
        ]
    }

    withName: 'PLOT_CONTINUOUS_CONTRAST' {
        publishDir = [
            path: { "${params.outdir}/contrast_figs/continuous/${mode}/${key}" },
            mode: 'copy'
        ]
    }

    withName: 'GET_GRANT_SUMMARY' {
        publishDir = [
            path: { "${params.outdir}/grant_summary" },
            mode: 'copy'
        ]
    }
}
